<div class="form-group well" ng-if="attrs.multiple == 'false'">
    <label for="attrs.id">{{attrs.label}}</label><br>
    <a
            href
            ng-click="downloadFile('/api/attachments/task/'+ data.taskId +'/'+ document.name +'/data', document.name, document.mimetype)" >
        {{document.filename}}
    </a>
    <button class="btn btn-xs btn-info" ng-class="{'btn-warning': attachments[attrs.name].name}"
            ng-model="$parent.data[attrs.name]"
            ngf-select
            name="$parent.data[attrs.name]"
            accept="{{attrs.accept}}"
            ngf-multiple="false"
            ng-required="attrs['cnrRequired'] == 'true'" >
        <span ng-show="!document" class="glyphicon glyphicon-upload"></span>
        <span ng-show="document.name" class="glyphicon glyphicon-repeat"></span>
        <span ng-show="!document">Carica Documento</span>
        <span ng-show="document.name">Aggiorna</span>
    </button>
    <span ng-show="$parent.data[attrs.name]">
          {{$parent.data[attrs.name].name}}
          <a href ng-click="$parent.data[attrs.name] = undefined"><span
                  class="glyphicon glyphicon-remove" title="Rimuovi"></span></a>
      </span>
</div>

<div class="form-group well" ng-if="attrs.multiple == 'true'">
    <div ng-repeat="(name, attachment) in attachments" ng-if="filterNames(attachment)">
        <label for="attrs.id">{{attrs.label}}</label><br>
        <a
                href
                ng-click="downloadFile('/api/attachments/task/'+ data.taskId +'/'+ attachment.name +'/data', attachment.name,attachment.mimetype)" >
            {{attachment.filename}}
        </a>
        <button class="btn btn-xs btn-info"
                ng-model="$parent.data[attachment.name]"
                ngf-select
                name="$parent.data[attachment.name]"
                accept="{{attrs.accept}}"
                ngf-multiple="false"
                ng-required="attrs['cnrRequired'] == 'true'" >
            <span class="glyphicon glyphicon-repeat"></span> Aggiorna
        </button>
        {{$parent.data[attachment.name].name}}
    </div>
    <label for="attrs.id">{{attrs.labelplural || attrs.label}}</label><br>
    <button class="btn btn-xs btn-info"
            ng-model="$parent.data['__new__'+attrs.name]"
            ngf-select
            name="$parent.data['__new__'+attrs.name]"
            accept="{{attrs.accept}}"
            ngf-multiple="true"
            ng-required="attrs['cnrRequired'] == 'true'" >
        <span class="glyphicon glyphicon-upload"></span>
        <span ng-show="!$parent.data[attrs.name].name"> Carica Documenti</span>
    </button>
    <span ng-show="$parent.data['__new__'+attrs.name].length">
        Documenti selezionati:
        <span ng-repeat="att in $parent.data['__new__'+attrs.name]">
          {{att.name}}
                  <a href ng-click="$parent.data['__new__'+attrs.name].splice($index, 1)"><span
                          class="glyphicon glyphicon-remove" title="Rimuovi"></span></a><span ng-if="!$last">  </span>, </span>
        </span>
    </span>
</div>
