<div ng-cloak>
	<div class="row form-group">
		<div class="col-md-12">
			<uib-tabset active="indextab" justified="true" type="pills">
				<uib-tab index="0" classes="{{vm.searchParams.active == true ? 'pi-active' : ''}}" select="vm.searchParams.active = true; vm.searchParams.page = 1; search()">
					<uib-tab-heading>
						<h3>
							<em class="glyphicon glyphicon-edit"></em>
							Flussi Attivi
						</h3>
					</uib-tab-heading>
				</uib-tab>
				<uib-tab index="1" classes="{{vm.searchParams.active == true ? '' : 'pi-terminated'}}" select="vm.searchParams.active = false; vm.searchParams.page = 1; search()">
					<uib-tab-heading>
						<h3>
							<em class="glyphicon glyphicon-check"></em>
							Flussi Terminati
						</h3>
					</uib-tab-heading>
				</uib-tab>
			</uib-tabset>
		</div>
	</div>
	<div class="row">
		<div class="col-md-3 padding-top">

			<div>
				<h4>Ordinamento temporale</h4>
				<div>
					<button class="btn btn-default btn-block margin-top-20" ng-click="vm.searchParams.order ===  'ASC' ?  vm.searchParams.order  = 'DESC' : vm.searchParams.order  = 'ASC'; search()">
						<span class="glyphicon glyphicon-sort"></span>
						{{vm.searchParams.order === 'ASC' ? 'Crescente' : 'Descrescente'}}
					</button>
				</div>
			</div>

			<br>
			<h4>Tipologie</h4>
			<div id="tipologieDiv">
				<div>
					<div class="dropdown md-menu-origin">
						<ui-select ng-model="vm.searchParams.processDefinitionKey" title="Tipologie" on-select="search()">
							<ui-select-match placeholder="Seleziona la tipologia di flusso" allow-clear="true">
								{{$select.selected.name}}
							</ui-select-match>
							<ui-select-choices repeat="processDefinition.key as processDefinition in wfDefsAll">
								<span ng-bind-html="processDefinition.name"></span>
							</ui-select-choices>
						</ui-select>
					</div>
					<br>
					<div>
						<ng-include id="searchFields" src="formUrl" onload="reload"></ng-include>
					</div>
				</div>
			</div>
			<br>
			<br>
			<button ng-click="vm.searchParams.page = 1; search()" class="btn btn-primary">
				<span class="glyphicon glyphicon-filter"></span>
				Filtra
			</button>
			<button ng-click="exportCsv()" class="btn btn-info">
				<span class="glyphicon glyphicon-export"></span>
				Esporta Csv
			</button>
		</div>


		<div id="resultDiv" class="col-md-9" ng-cloak>
			<h3>Flussi {{vm.searchParams.active ? 'attivi' : 'terminati'}}</h3>
			<!--Paginazione -->
			<div class="row" ng-show="vm.totalItems > 0">
				<div class="text-center col-md-12">
					<jhi-item-count page="vm.searchParams.page" total="vm.totalItems" items-per-page="20"></jhi-item-count>
					<uib-pagination class="{{vm.searchParams.active == true ? 'pi-active' : 'pi-terminated'}}" total-items="vm.totalItems" ng-model="vm.searchParams.page" ng-change="search()"></uib-pagination>
				</div>
			</div>

			<div class="row">
				<div ng-show="vm.loading" class="text-center col-md-12">
					<div ng-show="vm.loading" class="sprint-loader sprint-loader-mini"></div>
					Loading...
				</div>
				<div ng-hide="vm.loading" class="col-md-12">
					<process-list processes="vm.results" paging="paging" gpick="vm.searchParams.active == true ? 'pi-active' : 'pi-terminated'"></process-list>
				</div>
			</div>
			<!--Paginazione -->
			<div class="row">
				<div class="text-center col-md-12" ng-show="vm.totalItems > 0">
					<jhi-item-count page="vm.searchParams.page" total="vm.totalItems" items-per-page="20"></jhi-item-count>
					<uib-pagination class="{{vm.searchParams.active == true ? 'pi-active' : 'pi-terminated'}}" total-items="vm.totalItems" ng-model="vm.searchParams.page" ng-change="search()"></uib-pagination>
				</div>
			</div>
		</div>
	</div>
</div>

<pre ng-if="isDevelopment"> {{vm | json}} </pre>